#!/usr/bin/env xcrun --sdk macosx swift

import Foundation

var tabs = 0

extension String {
	mutating func addLine(line: String = "") {
		
		if line.characters.last == "}" {
			tabs -= 1
		}
		if tabs > 0 {
			self += String(count: tabs, repeatedValue: Character("\t"))
		}

		self += "\(line)\n"

		if line.characters.last == "{" {
			tabs += 1
		}
	}
}

let outputPath = Process.arguments[1]

var outputString = ""
outputString.addLine("// autogenerated by genswiftimages.swift\n")
outputString.addLine("import UIKit\n")
outputString.addLine("enum Images: String {")

Process.arguments[2..<Process.arguments.count].forEach {
	let url = NSURL(fileURLWithPath: $0)
	outputString.addLine("case \(url.URLByDeletingPathExtension!.lastPathComponent!.stringByReplacingOccurrencesOfString("-", withString:"__"))")
}
outputString.addLine("")
outputString.addLine("var image: UIImage? {")
outputString.addLine("return UIImage(named: rawValue.stringByReplacingOccurrencesOfString(\"__\", withString:\"-\"))")
outputString.addLine("}")
outputString.addLine("}")

try! outputString.writeToFile(outputPath, atomically: true, encoding: NSUTF8StringEncoding)
